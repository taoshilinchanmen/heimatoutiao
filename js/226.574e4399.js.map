{"version":3,"file":"js/226.574e4399.js","mappings":"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","sources":["webpack://toutiao-m/./src/views/search/search.vue","webpack://toutiao-m/./src/views/search/components/search-history.vue","webpack://toutiao-m/src/views/search/components/search-history.vue","webpack://toutiao-m/./src/views/search/components/search-history.vue?8ea9","webpack://toutiao-m/./src/views/search/components/search-history.vue?e2fe","webpack://toutiao-m/./src/views/search/components/search-suggestion.vue","webpack://toutiao-m/src/views/search/components/search-suggestion.vue","webpack://toutiao-m/./src/views/search/components/search-suggestion.vue?f1b1","webpack://toutiao-m/./src/views/search/components/search-suggestion.vue?9884","webpack://toutiao-m/./src/views/search/components/search-result.vue","webpack://toutiao-m/src/views/search/components/search-result.vue","webpack://toutiao-m/./src/views/search/components/search-result.vue?eb8a","webpack://toutiao-m/./src/views/search/components/search-result.vue?b3d2","webpack://toutiao-m/src/views/search/search.vue","webpack://toutiao-m/./src/views/search/search.vue?aa84","webpack://toutiao-m/./src/views/search/search.vue?e193"],"sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"search-container\"},[_c('form',{attrs:{\"action\":\"/\"}},[_c('van-search',{attrs:{\"background\":\"#3296FA\",\"show-action\":\"\",\"placeholder\":\"请输入搜索关键词\"},on:{\"search\":_vm.onSearch,\"cancel\":_vm.onCancel,\"focus\":function($event){_vm.isResultShow = false}},model:{value:(_vm.searchText),callback:function ($$v) {_vm.searchText=$$v},expression:\"searchText\"}})],1),(_vm.isResultShow)?_c('search-result',{attrs:{\"searchText\":_vm.searchText}}):(_vm.searchText)?_c('search-suggestion',{attrs:{\"searchText\":_vm.searchText},on:{\"search\":_vm.onSearch}}):_c('search-history',{ref:\"search-history\",attrs:{\"searchHistories\":_vm.searchHistories},on:{\"clearAll\":function($event){_vm.searchHistories = []},\"clearHistory\":_vm.onClearHistory,\"search\":_vm.onSearch}})],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"search-history\"},[_c('van-cell',{attrs:{\"title\":\"搜索历史\"},scopedSlots:_vm._u([{key:\"right-icon\",fn:function(){return [(_vm.isDeleteShow)?[_c('span',{staticStyle:{\"margin-right\":\"4px\"},on:{\"click\":_vm.clearAll}},[_vm._v(\"全部删除\")]),_c('span',[_vm._v(\"完成\")])]:_c('van-icon',{staticClass:\"delete-icon\",attrs:{\"name\":\"delete\"},on:{\"click\":function($event){_vm.isDeleteShow = true}}})]},proxy:true}])}),_vm._l((_vm.searchHistories),function(value,index){return _c('van-cell',{key:index,attrs:{\"title\":value},on:{\"click\":function($event){return _vm.onClearHistory(value, index)}},scopedSlots:_vm._u([(_vm.isDeleteShow)?{key:\"right-icon\",fn:function(){return [_c('van-icon',{staticClass:\"delete-icon\",attrs:{\"name\":\"close\"}})]},proxy:true}:null],null,true)})})],2)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <!-- 搜索历史列表 -->\r\n  <div class=\"search-history\">\r\n    <van-cell title=\"搜索历史\">\r\n      <template #right-icon>\r\n        <!-- template标签，在html结构中可以作为包裹部分的一个总体盒子，这个盒子并不会作为标签显示到真实dom上 -->\r\n        <template v-if=\"isDeleteShow\">\r\n          <span style=\"margin-right: 4px\" @click=\"clearAll\">全部删除</span>\r\n          <span>完成</span>\r\n        </template>\r\n        <van-icon name=\"delete\" class=\"delete-icon\" v-else @click=\"isDeleteShow = true\"/>\r\n      </template>\r\n    </van-cell>\r\n\r\n    <van-cell\r\n      v-for=\"(value, index) in searchHistories\"\r\n      :key=\"index\"\r\n      :title=\"value\"\r\n      @click=\"onClearHistory(value, index)\"\r\n    >\r\n      <template #right-icon v-if=\"isDeleteShow\">\r\n        <van-icon name=\"close\" class=\"delete-icon\" />\r\n      </template>\r\n    </van-cell>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n/*\r\n  谁的业务，写在谁身上, 如果该业务收到其他的功能影响，无法通过常规的思路实现时，尝试把改业务中的某些受到影响的变量，写的影响源（父组件）上\r\n*/\r\nexport default {\r\n  name: 'SearchHistory',\r\n  props: {\r\n    searchHistories: {\r\n      type: Array,\r\n      default: () => []\r\n    }\r\n  },\r\n  data () {\r\n    return {\r\n      isDeleteShow: false // 控制删除状态的显示\r\n    }\r\n  },\r\n  methods: {\r\n    // 删除全部\r\n    clearAll () {\r\n      this.$emit('clearAll')\r\n    },\r\n\r\n    // 单个删除\r\n    onClearHistory (value, index) {\r\n      // 判断是否是删除状态\r\n      if (this.isDeleteShow) {\r\n        // 删除历史\r\n        this.$emit('clearHistory', index)\r\n      } else {\r\n        // 直接进入搜索\r\n        this.$emit('search', value)\r\n      }\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.search-history {\r\n  .delete-icon {\r\n    font-size: 28px;\r\n    line-height: 48px;\r\n  }\r\n}\r\n</style>\r\n","import mod from \"-!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./search-history.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./search-history.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./search-history.vue?vue&type=template&id=26333b42&scoped=true&\"\nimport script from \"./search-history.vue?vue&type=script&lang=js&\"\nexport * from \"./search-history.vue?vue&type=script&lang=js&\"\nimport style0 from \"./search-history.vue?vue&type=style&index=0&id=26333b42&prod&lang=less&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"26333b42\",\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"search-suggestion\"},_vm._l((_vm.suggestionList),function(item,index){return _c('van-cell',{key:index,attrs:{\"icon\":\"search\"},on:{\"click\":function($event){return _vm.$emit('search', item)}},scopedSlots:_vm._u([{key:\"title\",fn:function(){return [_c('span',{domProps:{\"innerHTML\":_vm._s(_vm.highlight(item))}})]},proxy:true}],null,true)})}),1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n<!-- 联想列表 -->\r\n  <div class=\"search-suggestion\">\r\n    <van-cell\r\n      v-for=\"(item, index) in suggestionList\"\r\n      :key=\"index\"\r\n      icon=\"search\"\r\n      @click=\"$emit('search', item)\"\r\n    >\r\n      <template #title>\r\n        <span v-html=\"highlight(item)\"></span>\r\n      </template>\r\n    </van-cell>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { getSearchSuggestionsAPI } from '../../../api/index.js'\r\n// 引入防抖方法\r\nimport { debounce } from 'lodash'\r\n\r\n// 手写防抖\r\n// 仅供拓展，有时间的时候背一背\r\n/*\r\nfunction myDebounce (callback, times) {\r\n  // 通过闭包延迟时间timer的什么周期\r\n  let timer = null // 计时器\r\n  // 高阶函数， 一个函数返回另一个函数\r\n  return function (val) {\r\n    const that = this\r\n    if (timer) {\r\n      return clearTimeout(timer)\r\n    }\r\n\r\n    timer = setTimeout(() => {\r\n      // 通过call改变this指向\r\n      callback.call(that, val)\r\n    }, times)\r\n  }\r\n}\r\n*/\r\n\r\nexport default {\r\n  name: 'SearchSuggestion',\r\n  props: {\r\n    searchText: {\r\n      type: String,\r\n      default: ''\r\n    }\r\n  },\r\n  data () {\r\n    return {\r\n      suggestionList: [] // 联想建议列表数据\r\n    }\r\n  },\r\n\r\n  watch: {\r\n    // searchText (newValue) {\r\n    //   // 输入第一个字符时并不会触发监听\r\n    //   console.log(newValue)\r\n    // }\r\n\r\n    searchText: {\r\n      // lodash的防抖函数必须使用普通函数 debounce(function(){}, 连续触发事件)\r\n      handler: debounce(function (newValue) {\r\n        // 调用查询联想列表方法\r\n        this.loadSearchSuggestion(newValue)\r\n      }, 200),\r\n      immediate: true // 首次监听触发\r\n    }\r\n  },\r\n\r\n  methods: {\r\n    // 查询数据接口\r\n    async loadSearchSuggestion (newVal) {\r\n      try {\r\n        const { data: res } = await getSearchSuggestionsAPI(newVal)\r\n        console.log(res)\r\n        // 调用接口是发现，有些情况下后端会返回一个[null]的情况，针对这种情况，我们可以主动地将这个null改写为当前searchText的值\r\n        if (res.data.options && res.data.options[0] == null) {\r\n          // 判断有无options数组，并且数组的第0项是不是空\r\n          res.data.options[0] = this.searchText\r\n        }\r\n\r\n        // // 实现高亮文字结构的处理 后 => <span style=\"color: red\">后</span>\r\n        // // 方法一： 正则表达式替换 \\正则\\ + replace\r\n        // const list = res.data.options.map(item => {\r\n        //   // 1. 设置关键字高亮文本样式\r\n        //   const highlightStr = `<span style=\"color: red\">${newVal}</span>`\r\n        //   // 2. 更具输入框内容创建正则规则\r\n        //   const reg = new RegExp(newVal, 'gi')\r\n\r\n        //   // 3. 通过 \\正则\\ + replace 进行文本替换\r\n        //   return item.replace(reg, highlightStr)\r\n        // })\r\n        // this.suggestionList = list\r\n\r\n        // // 方法二： split 与 join 结合使用\r\n        // const list2 = res.data.options.map(item => {\r\n        //   // 1. 设置关键字的高亮文本样式\r\n        //   const highlightStr = `<span style=\"color: red\">${newVal}</span>`\r\n        //   // 2. 通过split方法将目标字符串拆分成数组\r\n        //   // 3. 通过join方法，将 highlightStr 拼接到每个元素之间\r\n        //   return item.split(newVal).join(highlightStr)\r\n        // })\r\n        // this.suggestionList = list2\r\n        this.suggestionList = res.data.options\r\n        console.log(this.suggestionList)\r\n      } catch (error) {\r\n        this.$toast('获取列表失败')\r\n      }\r\n    },\r\n\r\n    // 提取高亮文本方法\r\n    highlight (item) {\r\n      // 1. 设置关键字的高亮文本样式\r\n      const highlightStr = `<span style=\"color: red\">${this.searchText}</span>`\r\n      // 2. 通过split方法将目标字符串拆分成数组\r\n      // 3. 通过join方法，将 highlightStr 拼接到每个元素之间\r\n      return item.split(this.searchText).join(highlightStr)\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n\r\n</style>\r\n","import mod from \"-!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./search-suggestion.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./search-suggestion.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./search-suggestion.vue?vue&type=template&id=c484d9fc&scoped=true&\"\nimport script from \"./search-suggestion.vue?vue&type=script&lang=js&\"\nexport * from \"./search-suggestion.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"c484d9fc\",\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"search-result\"},[_c('van-list',{attrs:{\"finished\":_vm.finished,\"finished-text\":\"没有更多了\",\"error\":_vm.error,\"error-text\":\"请求失败，点击重新加载\"},on:{\"update:error\":function($event){_vm.error=$event},\"load\":_vm.onLoad},model:{value:(_vm.loading),callback:function ($$v) {_vm.loading=$$v},expression:\"loading\"}},_vm._l((_vm.list),function(item){return _c('van-cell',{key:item.art_id,attrs:{\"title\":item.title}})}),1)],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n<!-- 搜索结果 -->\r\n  <div class=\"search-result\">\r\n    <van-list\r\n      v-model=\"loading\"\r\n      :finished=\"finished\"\r\n      finished-text=\"没有更多了\"\r\n      :error.sync=\"error\"\r\n      error-text=\"请求失败，点击重新加载\"\r\n      @load=\"onLoad\"\r\n    >\r\n      <van-cell v-for=\"item in list\" :key=\"item.art_id\" :title=\"item.title\" />\r\n    </van-list>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { getSearchResultAPI } from '../../../api/index.js'\r\nexport default {\r\n  name: 'SearchResult',\r\n  props: {\r\n    searchText: {\r\n      type: String,\r\n      default: ''\r\n    }\r\n  },\r\n  data () {\r\n    return {\r\n      page: 1, // 当前页码\r\n      perPage: 20, // 每页的请求数量\r\n      list: [],\r\n      loading: false,\r\n      finished: false,\r\n      error: false\r\n    }\r\n  },\r\n  methods: {\r\n    async onLoad () {\r\n      // 1. 请求获取更新数据\r\n      try {\r\n        const { data: res } = await getSearchResultAPI({\r\n          page: this.page, // 页码\r\n          per_page: this.perPage, // 每页数量\r\n          q: this.searchText\r\n        })\r\n        // 2. 将数据添加到列表中\r\n        console.log(res.data.results)\r\n        this.list.push(...res.data.results)\r\n\r\n        // 3. 设置加载状态的关闭\r\n        this.loading = false\r\n\r\n        // 4. 判断数据是否完全加载完毕 - finished的状态调整\r\n        if (res.data.results.length) {\r\n          // 更新下一页的页码\r\n          this.page++\r\n        } else {\r\n          // 列表长度为0时，表明没有数据了，那么放finished改为true 不在调用onload\r\n          this.finished = true\r\n        }\r\n      } catch (error) {\r\n        // 展示夹杂失败的提示\r\n        this.error = true\r\n        this.loading = false\r\n        this.$toast('请求失败，请稍后重试')\r\n      }\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n\r\n</style>\r\n","import mod from \"-!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./search-result.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./search-result.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./search-result.vue?vue&type=template&id=0a6bf6ee&scoped=true&\"\nimport script from \"./search-result.vue?vue&type=script&lang=js&\"\nexport * from \"./search-result.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"0a6bf6ee\",\n  null\n  \n)\n\nexport default component.exports","<template>\r\n  <div class=\"search-container\">\r\n    <!-- 顶部搜索 -->\r\n    <!-- 在van-search外层，添加from标签，且active属性不能为空，即可在ios输入法中显示搜索按钮 -->\r\n    <form action=\"/\">\r\n      <van-search\r\n        v-model=\"searchText\"\r\n        background=\"#3296FA\"\r\n        show-action\r\n        placeholder=\"请输入搜索关键词\"\r\n        @search=\"onSearch\"\r\n        @cancel=\"onCancel\"\r\n        @focus=\"isResultShow = false\"\r\n      />\r\n    </form>\r\n\r\n    <!-- 搜索结果 -->\r\n    <search-result v-if=\"isResultShow\" :searchText=\"searchText\"></search-result>\r\n\r\n    <!-- 联想列表 -->\r\n    <search-suggestion v-else-if=\"searchText\" :searchText=\"searchText\" @search=\"onSearch\"></search-suggestion>\r\n\r\n    <!-- 搜索历史 -->\r\n    <!-- 组件的ref可以让父组件去调用子组件的方法 / 使用子组件的变量 -->\r\n    <search-history\r\n      v-else ref=\"search-history\"\r\n      :searchHistories=\"searchHistories\"\r\n      @clearAll=\"searchHistories = []\"\r\n      @clearHistory=\"onClearHistory\"\r\n      @search=\"onSearch\"\r\n    ></search-history>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n/*\r\n  防抖：\r\n    当你在某个时间节点内持续触发某个事件时，只会在最后一次生效\r\n  节流：\r\n    在某个时间段内，只能触发一次\r\n*/\r\nimport SearchHistory from './components/search-history.vue'\r\nimport SearchSuggestion from './components/search-suggestion.vue'\r\nimport SearchResult from './components/search-result.vue'\r\nimport { getItem, setItem } from '../../utils/storage.js'\r\nexport default {\r\n  name: 'searchIndex',\r\n  components: {\r\n    SearchHistory,\r\n    SearchSuggestion,\r\n    SearchResult\r\n  },\r\n  data () {\r\n    return {\r\n      searchText: '', // 搜索框文本\r\n      isResultShow: false, // 是否展示搜索结果\r\n      searchHistories: getItem('TOUTIAO_SEARCH_HISTORY') || [] // 搜索历史记录列表\r\n    }\r\n  },\r\n\r\n  watch: {\r\n    searchHistories: {\r\n      handler (newVal) {\r\n        setItem('TOUTIAO_SEARCH_HISTORY', newVal)\r\n      },\r\n      deep: true\r\n    }\r\n  },\r\n\r\n  methods: {\r\n    // 搜索事件\r\n    // value: 表示的是输入框中的值\r\n    /*  */\r\n    onSearch (value) {\r\n      // 将当前的内容赋值给输入框\r\n      this.searchText = value\r\n      // 主动开启搜索结果组件\r\n      this.isResultShow = true\r\n\r\n      // 将搜索框的内容放到搜索历史列表中\r\n      this.onAddTarget(value)\r\n    },\r\n\r\n    // 添加历史数据\r\n    onAddTarget (value) {\r\n      /* 需求：\r\n          1. 保存的内容需要放到列表的最顶端 - unshift()\r\n          2. 不能有重复的历史记录，需要查重 - indexOf() / find() / findIndex() / includes()\r\n      */\r\n      // 判断在原数组中有没有该字符串\r\n      const index = this.searchHistories.indexOf(value)\r\n\r\n      if (index !== -1) {\r\n        // 列表中有该元素 - 删除该元素\r\n        this.searchHistories.splice(index, 1)\r\n      }\r\n      // 将value更新到列表的最顶端\r\n      this.searchHistories.unshift(value)\r\n      console.log(this.searchHistories, 'onAddTarget')\r\n    },\r\n\r\n    // 删除单独历史\r\n    onClearHistory (index) {\r\n      this.searchHistories.splice(index, 1)\r\n    },\r\n\r\n    // 关闭事件\r\n    onCancel () {\r\n      this.$toast('取消搜索')\r\n      // 返回前一个路由页面\r\n      this.$router.back()\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.search-container {\r\n  padding-top: 108px;\r\n  .van-search__action {\r\n    color: #fff;\r\n  }\r\n\r\n  // 将搜索栏置顶， 并设置padding-top来限制文本区域的滚动范围\r\n  .van-search {\r\n    position: fixed;\r\n    top: 0;\r\n    left: 0;\r\n    right: 0;\r\n    z-index: 1;\r\n  }\r\n}\r\n</style>\r\n","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./search.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./search.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./search.vue?vue&type=template&id=72445e02&scoped=true&\"\nimport script from \"./search.vue?vue&type=script&lang=js&\"\nexport * from \"./search.vue?vue&type=script&lang=js&\"\nimport style0 from \"./search.vue?vue&type=style&index=0&id=72445e02&prod&lang=less&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"72445e02\",\n  null\n  \n)\n\nexport default component.exports"],"names":["render","_vm","this","_c","_self","staticClass","attrs","on","onSearch","onCancel","$event","isResultShow","model","value","searchText","callback","$$v","expression","ref","searchHistories","onClearHistory","staticRenderFns","scopedSlots","_u","key","fn","isDeleteShow","staticStyle","clearAll","_v","proxy","_l","index","name","props","type","default","data","methods","component","suggestionList","item","$emit","domProps","_s","highlight","watch","handler","immediate","console","res","finished","error","onLoad","loading","list","art_id","title","page","perPage","per_page","q","components","SearchHistory","SearchSuggestion","SearchResult","setItem","deep","onAddTarget"],"sourceRoot":""}